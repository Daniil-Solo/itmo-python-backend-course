## Домашнее задание №2

### О задании
1. Придумать бизнес сценарий для вашего веб приложения и описать его
2. Написать Endpoint’ы для бизнес сценариев и вынести логику работы в отдельные модули/функции
3. Бизнес логика должна быть достаточно сложной, чтобы описать её в как минимум трех функциях/методах
4. Разработать хотя бы по три модульных теста для каждой функции/метода
5. Разработать три интеграционных теста
6. Задокументировать, как автоматически выполнять тесты


### О решении
1. Тематика "Выбор дисциплин"
   - Пользователем является студент, выбирающий дисциплины на следующий семестр;
   - Пользователь заранее определяет нагрузку на семестр — количество изучаемых дисциплин, которые нужно выбрать; 
   - Выбранные дисциплины не должны повторяться, пересекаться по времени и их количество не должно выходить за рамки
     указанной нагрузки на семестр;
   - При некорректном выборе пользователь должен получать объяснение причины отказа в планировании дисциплины;
   - После завершения составления учебного плана студент должен подтвердить свой выбор, после чего изменить выбор уже будет невозможно;
   - Для простоты решения считается, что курсы и студенты созданы заранее в системе, а пользователи прошли аутентификацию;
   - Одному студенту соответствует один план изучения дисциплин;
   - Пренебрегая безопасностью, каждый запрос пользователя содержит должен содержать идентификатор студента в заголовке запроса.
   
2. Разработка API
   
   - Созданы модели предметной области, написан скрипт для генерации данных при старте приложения
   
   - Написаны эндпоинты, логика по взаимодействию вынесена в сервисы, а доступ к данным реализован с помощью паттерна Репозиторий

3. Бизнес логика достаточно сложная, особенно в сервисе по работе с выбором курсов
   
4. Разработаны юнит-тесты для 3 функций/классов (с использованием pytest и pytest-asyncio)
   
5. Разработано 8 интеграционных тестов (с использованием pytest и httpx)
   
6. Инструкция по запуску тестов прилагается ниже

### Установка зависимостей
```cmd
pip install poetry
poetry install
```

### Переменные окружения
Для запуска приложение использует переменные из файла .env.example 
```
MODE=DEV
DB_FILEPATH=PATH_YOUR_DB_DIRECTORY\YOUR_DB_NAME.sqlite
```

### Запуск приложения
База данных будет создана автоматически по пути, указанном в env-файле
```cmd
cd ./"Homework 2"/src
poetry run uvicorn app:app --port=5000
```

### Линтеры
В проекте используется Pylint. Для запуска необходимо находиться в корне проекта, чтобы применилась конфигурация для pylint
```cmd
poetry run pylint "Homework 2"/src/database/db.py
poetry run pylint "Homework 2"/src/database/base.py
poetry run pylint "Homework 2"/src/database/data.py

poetry run pylint "Homework 2"/src/courses/utils.py
poetry run pylint "Homework 2"/src/courses/services.py
poetry run pylint "Homework 2"/src/courses/schemas.py
poetry run pylint "Homework 2"/src/courses/router.py
poetry run pylint "Homework 2"/src/courses/exceptions.py
poetry run pylint "Homework 2"/src/courses/dependencies.py
poetry run pylint "Homework 2"/src/courses/constants.py
poetry run pylint "Homework 2"/src/courses/models.py

poetry run pylint "Homework 2"/src/app.py
poetry run pylint "Homework 2"/src/config.py

poetry run pylint "Homework 2"/src/tests/test_unit.py
poetry run pylint "Homework 2"/src/tests/test_integration.py
```
Все файлы прошли проверку pylint на 10 (кроме скриптов с тестами)

### Тестирование
#### Запуск unit-тестов
```cmd
cd ./"Homework 2"/src
poetry run pytest tests/test_unit.py
```
#### Запуск интеграционных тестов
Установить переменную окружения `MODE=TEST`, 
для того чтобы при тестировании каждый раз создавалась тестовая БД
```cmd
cd ./"Homework 2"/src
poetry run pytest tests/test_integration.py -v
```
